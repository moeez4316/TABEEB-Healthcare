// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}


model User {
  uid  String @id @db.VarChar(255)
  role String @db.VarChar(50) // 'doctor' or 'patient'

  doctor  Doctor?
  patient Patient?
}

model Doctor {
  uid            String   @id @db.VarChar(255)
  name           String   @db.VarChar(255)
  email          String   @unique @db.VarChar(255)
  phone          String?  @db.VarChar(20)
  specialization String   @db.VarChar(100)
  qualification  String   @db.Text
  experience     Int?
  createdAt      DateTime @default(now())

  user User @relation(fields: [uid], references: [uid])

  verification Verification?
}

model Patient {
  uid            String   @id @db.VarChar(255)
  name           String   @db.VarChar(255)
  email          String   @unique @db.VarChar(255)
  phone          String?  @db.VarChar(20)
  dob            DateTime 
  gender         String   @db.VarChar(10)
  medicalHistory String?  @db.Text
  createdAt      DateTime @default(now())

  user User @relation(fields: [uid], references: [uid])
}

model Verification {
  doctorUid      String   @id @db.VarChar(255)
  isVerified     Boolean  @default(false)
  status         String   @default("pending") @db.VarChar(20) // "pending", "approved", "rejected"
  cnic           String   @db.Text // Cloudinary URL
  pmdcNumber     String   @db.VarChar(50)
  certificate    String?  @db.Text // Cloudinary URL
  adminComments  String?  @db.Text // Rejection reason or admin notes
  submittedAt    DateTime @default(now())
  reviewedAt     DateTime?
  reviewedBy     String?  @db.VarChar(255) // Admin who reviewed

  doctor         Doctor   @relation(fields: [doctorUid], references: [uid])
}